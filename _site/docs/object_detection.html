<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Object Detection | UNav-Sim</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Object Detection" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<meta property="og:description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<link rel="canonical" href="http://localhost:4000/docs/object_detection.html" />
<meta property="og:url" content="http://localhost:4000/docs/object_detection.html" />
<meta property="og:site_name" content="UNav-Sim" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Object Detection" />
<script type="application/ld+json">
{"url":"http://localhost:4000/docs/object_detection.html","headline":"Object Detection","@type":"WebPage","description":"Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">UNav-Sim</a></h1>
      

      <h1 id="object-detection">Object Detection</h1>

<h2 id="about">About</h2>
<p>This feature lets you generate object detection using existing cameras in AirSim, similar to detection DNN. <br />
Using the API you can control which object to detect by name and radius from camera. <br />
One can control these settings for each camera, image type and vehicle combination separately.</p>

<h2 id="api">API</h2>
<ul>
  <li>
    <p>Set mesh name to detect in wildcard format<br />
<code class="language-plaintext highlighter-rouge">simAddDetectionFilterMeshName(camera_name, image_type, mesh_name, vehicle_name = '')</code></p>
  </li>
  <li>
    <p>Clear all mesh names previously added<br />
<code class="language-plaintext highlighter-rouge">simClearDetectionMeshNames(camera_name, image_type, vehicle_name = '')</code></p>
  </li>
  <li>
    <p>Set detection radius in cm<br />
<code class="language-plaintext highlighter-rouge">simSetDetectionFilterRadius(camera_name, image_type, radius_cm, vehicle_name = '')</code></p>
  </li>
  <li>
    <p>Get detections<br />
<code class="language-plaintext highlighter-rouge">simGetDetections(camera_name, image_type, vehicle_name = '')</code></p>
  </li>
</ul>

<p>The return value of <code class="language-plaintext highlighter-rouge">simGetDetections</code> is a <code class="language-plaintext highlighter-rouge">DetectionInfo</code> array:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">DetectionInfo</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">''</span>
    <span class="n">geo_point</span> <span class="o">=</span> <span class="n">GeoPoint</span><span class="p">()</span>
    <span class="n">box2D</span> <span class="o">=</span> <span class="n">Box2D</span><span class="p">()</span>
    <span class="n">box3D</span> <span class="o">=</span> <span class="n">Box3D</span><span class="p">()</span>
    <span class="n">relative_pose</span> <span class="o">=</span> <span class="n">Pose</span><span class="p">()</span>
</code></pre></div></div>
<h2 id="usage-example">Usage example</h2>
<p>Python script <a href="https://github.com/microsoft/AirSim/blob/main/PythonClient/detection/detection.py">detection.py</a> shows how to set detection parameters and shows the result in OpenCV capture.</p>

<p>A minimal example using API with Blocks environment to detect Cylinder objects:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">camera_name</span> <span class="o">=</span> <span class="s">"0"</span>
<span class="n">image_type</span> <span class="o">=</span> <span class="n">airsim</span><span class="p">.</span><span class="n">ImageType</span><span class="p">.</span><span class="n">Scene</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">airsim</span><span class="p">.</span><span class="n">MultirotorClient</span><span class="p">()</span>
<span class="n">client</span><span class="p">.</span><span class="n">confirmConnection</span><span class="p">()</span>

<span class="n">client</span><span class="p">.</span><span class="n">simSetDetectionFilterRadius</span><span class="p">(</span><span class="n">camera_name</span><span class="p">,</span> <span class="n">image_type</span><span class="p">,</span> <span class="mi">80</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># in [cm]
</span><span class="n">client</span><span class="p">.</span><span class="n">simAddDetectionFilterMeshName</span><span class="p">(</span><span class="n">camera_name</span><span class="p">,</span> <span class="n">image_type</span><span class="p">,</span> <span class="s">"Cylinder_*"</span><span class="p">)</span> 
<span class="n">client</span><span class="p">.</span><span class="n">simGetDetections</span><span class="p">(</span><span class="n">camera_name</span><span class="p">,</span> <span class="n">image_type</span><span class="p">)</span>
<span class="n">detections</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">simClearDetectionMeshNames</span><span class="p">(</span><span class="n">camera_name</span><span class="p">,</span> <span class="n">image_type</span><span class="p">)</span>
</code></pre></div></div>

<p>Output result:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Cylinder</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">DetectionInfo</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'box2D'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Box2D</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'max'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Vector2r</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">617.025634765625</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="mf">583.5487060546875</span><span class="p">},</span>
    <span class="s">'min'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Vector2r</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">485.74359130859375</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="mf">438.33465576171875</span><span class="p">}},</span>
    <span class="s">'box3D'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Box3D</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'max'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Vector3r</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">4.900000095367432</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="mf">0.7999999523162842</span><span class="p">,</span>
    <span class="s">'z_val'</span><span class="p">:</span> <span class="mf">0.5199999809265137</span><span class="p">},</span>
    <span class="s">'min'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Vector3r</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">3.8999998569488525</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.19999998807907104</span><span class="p">,</span>
    <span class="s">'z_val'</span><span class="p">:</span> <span class="mf">1.5199999809265137</span><span class="p">}},</span>
    <span class="s">'geo_point'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">GeoPoint</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'altitude'</span><span class="p">:</span> <span class="mf">16.979999542236328</span><span class="p">,</span>
    <span class="s">'latitude'</span><span class="p">:</span> <span class="mf">32.28772183970703</span><span class="p">,</span>
    <span class="s">'longitude'</span><span class="p">:</span> <span class="mf">34.864785008379876</span><span class="p">},</span>
    <span class="s">'name'</span><span class="p">:</span> <span class="s">'Cylinder9_2'</span><span class="p">,</span>
    <span class="s">'relative_pose'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Pose</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'orientation'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Quaternionr</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'w_val'</span><span class="p">:</span> <span class="mf">0.9929741621017456</span><span class="p">,</span>
    <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">0.0038591264747083187</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.11333247274160385</span><span class="p">,</span>
    <span class="s">'z_val'</span><span class="p">:</span> <span class="mf">0.03381215035915375</span><span class="p">},</span>
    <span class="s">'position'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Vector3r</span><span class="o">&gt;</span> <span class="p">{</span>   <span class="s">'x_val'</span><span class="p">:</span> <span class="mf">4.400000095367432</span><span class="p">,</span>
    <span class="s">'y_val'</span><span class="p">:</span> <span class="mf">0.29999998211860657</span><span class="p">,</span>
    <span class="s">'z_val'</span><span class="p">:</span> <span class="mf">1.0199999809265137</span><span class="p">}}}</span>
</code></pre></div></div>

<p><img src="images/detection_ue4.png" alt="image" />
<img src="images/detection_python.png" alt="image" /></p>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
