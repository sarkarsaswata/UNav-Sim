<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Upgrading API Client Code | UNav-Sim</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Upgrading API Client Code" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<meta property="og:description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<link rel="canonical" href="http://localhost:4000/docs/upgrade_apis.html" />
<meta property="og:url" content="http://localhost:4000/docs/upgrade_apis.html" />
<meta property="og:site_name" content="UNav-Sim" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Upgrading API Client Code" />
<script type="application/ld+json">
{"url":"http://localhost:4000/docs/upgrade_apis.html","headline":"Upgrading API Client Code","@type":"WebPage","description":"Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">UNav-Sim</a></h1>
      

      <h1 id="upgrading-api-client-code">Upgrading API Client Code</h1>
<p>There have been several API changes in AirSim v1.2 that we hope removes inconsistency, adds future extensibility and presents cleaner interface. Many of these changes are however <em>breaking changes</em> which means you will need to modify your client code that talks to AirSim.</p>

<h2 id="quicker-way">Quicker Way</h2>
<p>While most changes you need to do in your client code are fairly easy, a quicker way is simply to take a look at the example code such as <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//multirotor/hello_drone.py">Hello Drone</a>or <a href="https://github.com/Microsoft/AirSim/tree/main/PythonClient//car/hello_car.py">Hello Car</a> to get gist of changes.</p>

<h2 id="importing-airsim">Importing AirSim</h2>
<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">AirSimClient</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>
<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">airsim</span>
</code></pre></div></div>

<p>Above assumes you have installed AirSim module using,</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install --user airsim
</code></pre></div></div>

<p>If you are running you code from PythonClient folder in repo then you can also do this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">setup_path</span> 
<span class="kn">import</span> <span class="nn">airsim</span>
</code></pre></div></div>

<p>Here setup_path.py should exist in your folder and it will set the path of <code class="language-plaintext highlighter-rouge">airsim</code> package in <code class="language-plaintext highlighter-rouge">PythonClient</code> repo folder. All examples in PythonClient folder uses this method.</p>

<h2 id="using-airsim-classes">Using AirSim Classes</h2>
<p>As we have everything now in package, you will need to use explicit namespace for AirSim classes like shown below.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client1</span> <span class="o">=</span> <span class="n">CarClient</span><span class="p">()</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client1</span> <span class="o">=</span> <span class="n">airsim</span><span class="p">.</span><span class="n">CarClient</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="airsim-types">AirSim Types</h2>

<p>We have moved all types in <code class="language-plaintext highlighter-rouge">airsim</code> namespace.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image_type</span> <span class="o">=</span> <span class="n">AirSimImageType</span><span class="p">.</span><span class="n">DepthVis</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">DrivetrainType</span><span class="p">.</span><span class="n">MaxDegreeOfFreedom</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">image_type</span> <span class="o">=</span> <span class="n">airsim</span><span class="p">.</span><span class="n">ImageType</span><span class="p">.</span><span class="n">DepthVis</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">airsim</span><span class="p">.</span><span class="n">DrivetrainType</span><span class="p">.</span><span class="n">MaxDegreeOfFreedom</span>
</code></pre></div></div>

<h2 id="getting-images">Getting Images</h2>

<p>Nothing new below, it’s just combination of above. Note that all APIs that previously took <code class="language-plaintext highlighter-rouge">camera_id</code>, now takes <code class="language-plaintext highlighter-rouge">camera_name</code> instead. You can take a look at <a href="image_apis.md#avilable_cameras">available cameras</a> here.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responses</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">simGetImages</span><span class="p">([</span><span class="n">ImageRequest</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">AirSimImageType</span><span class="p">.</span><span class="n">DepthVis</span><span class="p">)])</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">responses</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">simGetImages</span><span class="p">([</span><span class="n">airsim</span><span class="p">.</span><span class="n">ImageRequest</span><span class="p">(</span><span class="s">"0"</span><span class="p">,</span> <span class="n">airsim</span><span class="p">.</span><span class="n">ImageType</span><span class="p">.</span><span class="n">DepthVis</span><span class="p">)])</span>
</code></pre></div></div>

<h2 id="utility-methods">Utility Methods</h2>
<p>In earlier version, we provided several utility methods as part of <code class="language-plaintext highlighter-rouge">AirSimClientBase</code>. These methods are now moved to <code class="language-plaintext highlighter-rouge">airsim</code> namespace for more pythonic interface.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AirSimClientBase</span><span class="p">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">my_path</span><span class="p">,</span> <span class="n">img_rgba</span><span class="p">)</span> 

<span class="n">AirSimClientBase</span><span class="p">.</span><span class="n">wait_key</span><span class="p">(</span><span class="s">'Press any key'</span><span class="p">)</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">airsim</span><span class="p">.</span><span class="n">write_png</span><span class="p">(</span><span class="n">my_path</span><span class="p">,</span> <span class="n">img_rgba</span><span class="p">)</span>

<span class="n">airsim</span><span class="p">.</span><span class="n">wait_key</span><span class="p">(</span><span class="s">'Press any key'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="camera-names">Camera Names</h2>
<p>AirSim now uses <a href="image_apis.md#available_cameras">names</a> to reference cameras instead of index numbers. However to retain backward compatibility, these names are aliased with old index numbers as string.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span><span class="p">.</span><span class="n">simGetCameraInfo</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span><span class="p">.</span><span class="n">simGetCameraInfo</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span>

<span class="c1"># or
</span>
<span class="n">client</span><span class="p">.</span><span class="n">simGetCameraInfo</span><span class="p">(</span><span class="s">"front-center"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="async-methods">Async Methods</h2>
<p>For multirotors, AirSim had various methods such as <code class="language-plaintext highlighter-rouge">takeoff</code> or <code class="language-plaintext highlighter-rouge">moveByVelocityZ</code> that would take long time to complete. All of such methods are now renamed by adding the suffix <em>Async</em> as shown below.</p>

<p>Instead of,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span><span class="p">.</span><span class="n">takeoff</span><span class="p">()</span>

<span class="n">client</span><span class="p">.</span><span class="n">moveToPosition</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span><span class="p">.</span><span class="n">takeoffAsync</span><span class="p">().</span><span class="n">join</span><span class="p">()</span>

<span class="n">client</span><span class="p">.</span><span class="n">moveToPositionAsync</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">).</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></div>

<p>Here <code class="language-plaintext highlighter-rouge">.join()</code> is a call on Python’s <code class="language-plaintext highlighter-rouge">Future</code> class to wait for the async call to complete. You can also choose to do some other computation instead while the call is in progress.</p>

<h2 id="simulation-only-methods">Simulation-Only Methods</h2>
<p>Now we have clear distinction between methods that are only available in simulation from the ones that may be available on actual vehicle. The simulation only methods are prefixed with <code class="language-plaintext highlighter-rouge">sim</code> as shown below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>getCollisionInfo()      is renamed to       simGetCollisionInfo()
getCameraInfo()         is renamed to       simGetCameraInfo()
setCameraOrientation()  is renamed to       simSetCameraOrientation()
</code></pre></div></div>

<h2 id="state-information">State Information</h2>
<p>Previously <code class="language-plaintext highlighter-rouge">CarState</code> mixed simulation-only information like <code class="language-plaintext highlighter-rouge">kinematics_true</code>. Moving forward, <code class="language-plaintext highlighter-rouge">CarState</code> will only contain information that can be obtained in real world.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">k</span> <span class="o">=</span> <span class="n">car_state</span><span class="p">.</span><span class="n">kinematics_true</span>
</code></pre></div></div>

<p>use this:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">k</span> <span class="o">=</span> <span class="n">car_state</span><span class="p">.</span><span class="n">kinematics_estimated</span>

<span class="c1"># or
</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">simGetGroundTruthKinematics</span><span class="p">()</span>
</code></pre></div></div>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
