<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Playback | UNav-Sim</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Playback" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<meta property="og:description" content="Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features." />
<link rel="canonical" href="http://localhost:4000/docs/playback.html" />
<meta property="og:url" content="http://localhost:4000/docs/playback.html" />
<meta property="og:site_name" content="UNav-Sim" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Playback" />
<script type="application/ld+json">
{"url":"http://localhost:4000/docs/playback.html","headline":"Playback","@type":"WebPage","description":"Intended as a documentation theme based on Jekyll for technical writers documenting software and other technical products, this theme has all the elements you would need to handle multiple products with both multi-level sidebar navigation, tags, and other documentation features.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">UNav-Sim</a></h1>
      

      <h1 id="playback">Playback</h1>

<p>AirSim supports playing back the high level commands in a *.mavlink log file that were recorded using the MavLinkTest app
for the purpose of comparing real and simulated flight.
The <a href="logs/recording.mavlink">recording.mavlink</a> is an example of a log file captured using a real drone using the following
command line:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MavLinkTest -serial:/dev/ttyACM0,115200 -logdir:. 
</code></pre></div></div>

<p>Then the log file contains the commands performed, which included several “orbit” commands, the resulting GPS map of the flight
looks like this:</p>

<p><img src="images/RealFlight.png" alt="real flight" /></p>

<h2 id="side-by-side-comparison">Side-by-side comparison</h2>

<p>Now we can copy the *.mavlink log file recorded by MavLinkTest to the PC running the Unreal simulator with AirSim plugin.
When the Simulator is running and the drone is parked in a place in a map that has room to do the same maneuvers we can run this
MavLinkTest command line:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MavLinkTest -server:127.0.0.1:14550
</code></pre></div></div>

<p>This should connect to the simulator.  Now you can enter this command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PlayLog recording.mavlink
</code></pre></div></div>
<p>The same commands you performed on the real drone will now play again in the simulator.  You can then press ‘t’ to see
the trace, and it will show you the trace of the real drone and the simulated drone.  Every time you press ‘t’ again
you can reset the lines so they are sync’d to the current position, this way I was able to capture a side-by-side trace of the
“orbit” command performed in this recording, which generates the picture below.  The pink line is the simulated
flight and the red line is the real flight:</p>

<p><img src="images/Playback.png" alt="playback" /></p>

<p>Note: I’m using the ‘;’ key in the simulator to take control of camera position using keyboard to get this shot.</p>

<h2 id="parameters">Parameters</h2>

<p>It may help to set the simulator up with some of the same flight parameters that your real drone is using, for example,
in my case I was using a lower than normal cruise speed, slow takeoff speed, and it helps to tell the simulator to
wait a long time before disarming (COM_DISARM_LAND) and to turn off the safety switches NAV_RCL_ACT and NAV_DLL_ACT
(<code class="language-plaintext highlighter-rouge">don't</code> do that on a real drone).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>param MPC_XY_CRUISE 2
param MPC_XY_VEL_MAX 2
param MPC_TKO_SPEED 1
param COM_DISARM_LAND 60
param NAV_RCL_ACT 0
param NAV_DLL_ACT 0
</code></pre></div></div>



      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
